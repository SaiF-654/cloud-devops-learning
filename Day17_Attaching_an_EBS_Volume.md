Attaching and Configuring an EBS Volume in AWS EC2
🎯 Objective:
You will learn how to attach a new EBS volume to an existing EC2 instance, partition it, format it, mount it, and ensure it persists across reboots using /etc/fstab. This is a common task for cloud administrators to increase storage for applications like databases, logging, backups, or user data.

🏭 Real-life Industry Use Case:
Scenario:
 You are a DevOps Engineer working at a company running a web application on AWS EC2. The team needs a new EBS volume mounted at /mnt/data to store log files generated by the application. The data must persist across reboots.

✅ Prerequisites:
Running EC2 instance (Ubuntu)
EC2 console access
List All Disks
Lsblk
Create IAM user
IAM role attached with EC2 full permissions (or EC2 access via IAM user)



🛠️ Task Breakdown with Commands & Real-Time Outputs

1. Create and Attach a New EBS Volume
AWS Console:
Go to EC2 → Elastic Block Store → Volumes → Create Volume
Size: 5 GiB


Availability Zone: Match EC2 instance's zone (e.g., us-east-1a)
Make sure your the region for EC2 instance and volume should be same
Create


Attach it to EC2:
Actions → Attach Volume
Select instance → Device name: /dev/xvdf



2. List All Disks

lsblk

Expected Output:

NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
xvda    202:0    0   30G  0 disk /
└─xvda1 202:1    0   30G  0 part /
xvdf    202:80   0    5G  0 disk 

xvdf is the new disk.

What is Formatting a Partition?
Formatting a partition is like cleaning and labeling that cupboard section so you can store things in it properly.
[ Real-Life Example]
Imagine you just bought a new cupboard (hard drive). It's empty and has no shelves (no partitions).
So, first you:
Make shelves in it (create partitions).


Then you put lining paper and label each shelf (format the partition), like "Books", "Clothes", etc.


Now, you can easily store things on those shelves.
🖥️ Similarly, in a computer:
Partitioning is dividing the hard drive.
Formatting is preparing that partition with a file system (like a storage method) so the computer knows how to save and organize files there.
💡 Without Formatting, You Can't Use It!
If you don’t format the new partition, it’s like trying to place items in a dusty, unorganized, and unlabeled cupboard shelf—it won’t work properly.

🗂️ Different "Lining Papers" = Different File Systems
Just like there are different types of lining papers, in computers there are different file systems:
NTFS (for Windows)
EXT4 (for Linux)
FAT32/exFAT (for USBs and memory cards)



🔄 Summary:
Term
Real Life
Computer
Partition
Dividing cupboard into sections
Dividing hard drive into parts
Format
Lining and labeling a section
Preparing a partition with a file system
File System
Way of organizing items
Way of organizing files





3. Partition the New Disk

sudo fdisk /dev/xvdf

Steps inside fdisk:
n → new partition  
p → primary  
1 → partition number  
Enter → default first sector  
Enter → default last sector  
w → write and exit

Re-check with:

lsblk

Expected Output:

xvdf    202:80   0    5G  0 disk 
└─xvdf1 202:81   0    5G  0 part 


4. Format the New Partition

sudo mkfs.ext4 /dev/xvdf1

Output:

mke2fs 1.45.5 ...
Creating filesystem with 1310720 blocks ...


5. Create Mount Point & Mount the Disk

sudo mkdir /mnt/data
sudo mount /dev/xvdf1 /mnt/data


6. Verify Mount

df -h

Expected Output:
Filesystem      Size  Used Avail Use% Mounted on
/dev/xvda1       30G   1G   29G   4% /
/dev/xvdf1      4.9G   24M  4.6G   1% /mnt/data


7. Persist (Permanent) the Mount Using /etc/fstab
Get UUID:

sudo blkid /dev/xvdf1

Sample Output:

/dev/xvdf1: UUID="3f0d5ac2-2269-4e5e-800e-3dc9f5a21e25" TYPE="ext4"

Edit fstab:

sudo nano /etc/fstab

Add this line at the end:

UUID=3f0d5ac2-2269-4e5e-800e-3dc9f5a21e25 /mnt/data ext4 defaults,nofail 0 2


8. Test fstab Configuration

sudo mount -a

If no errors, it’s successful.

9. Reboot & Verify

sudo reboot

After reboot:

df -h | grep /mnt/data

Expected Output:

/dev/xvdf1      4.9G   24M  4.6G   1% /mnt/data


Example: Store project files or backups

cd /mnt/data
mkdir my_projects
cd my_projects
nano notes.txt

✅ Now you're storing your personal or work files on the new disk, not your system disk.

How to fix: Get permission to create folders inside /mnt/data

1. Check current permissions
Run:
bash
Copy code
ls -ld /mnt/data

You’ll see who owns the folder and the permissions.

2. Change ownership to your user (e.g., ubuntu)
If you are logged in as user ubuntu (common on AWS EC2), run:

sudo chown -R ubuntu:ubuntu /mnt/data

This changes owner & group of /mnt/data and all inside it to user ubuntu.

3. Now try creating the folder again:

mkdir /mnt/data/my_projects


Alternative: Use sudo to create folder (but not recommended for daily use):

sudo mkdir /mnt/data/my_projects

But better to fix ownership so you don’t need sudo every time.

Conclusion / Summary

In this class, you learned how to attach, partition, format, mount, and persist an EBS volume on an AWS EC2 instance — a common task for cloud admins. You used essential tools like lsblk, fdisk, and fstab to ensure the disk is available even after reboots.
This hands-on task reflects real-world scenarios, such as adding storage for logs or databases, and builds a strong foundation for more advanced cloud and DevOps operations.

